<!DOCTYPE html>
<html>
  <head>
    <title>TradingView Charting Library demo</title>

    <!-- Fix for iOS Safari zooming bug -->
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0"
    />

    <script
      type="text/javascript"
      src="assets/trading_view/charting_library/charting_library.standalone.js"
    ></script>
    <script
      type="text/javascript"
      src="assets/trading_view/datafeeds/udf/dist/bundle.js"
    ></script>
  </head>

  <body style="margin: 0px">
    <div id="tv_chart_container"></div>
    <script>
      function initialChartOption() {
        const widgetOptions = {
          symbol: "AAPL",
          datafeed: new Datafeeds.UDFCompatibleDatafeed(
            "https://demo-feed-data.tradingview.com"
          ),
          interval: "1D",
          container: "tv_chart_container",
          library_path: "assets/trading_view/charting_library/",
          locale: "en",
          disabled_features: [
            "symbol_info",
            "header_widget",
            "go_to_date",
            "timezone_menu",
            "border_around_the_chart",
            "display_market_status",
          ],
          enabled_features: [
            "hide_image_invalid_symbol",
            "adaptive_logo",
            "iframe_loading_compatibility_mode",
          ],
          fullscreen: true,
          autosize: true,
          debug: true,
          theme: "Dark",
        };

        return new TradingView.widget(widgetOptions);
      }

      function initOnReady() {
        console.log("[TradingView] initOnReady called");

        this._tvWidget = initialChartOption();
        this._tvWidget.onChartReady(() => {
          console.log("[TradingView] onChartReady called");

          // do some stuff
        });
      }

      window.addEventListener("DOMContentLoaded", initOnReady, false);
    </script>
  </body>
</html>
